#include <iostream>
#include <fstream>
#include <string>
#include <limits>
#include <vector>
#include <iomanip>
using namespace std;

class Perpus {
private:
    struct Pelanggan {
        string username;
        string nama;
        int umur;
        string sandi;
        int jum_sewa = 0;
        string buku_sewa[5];
        int hari_sewa[5];
        int harga_sewa[5];
        string review_buku[5];
        int jum_review = 0;
    };

    struct Buku {
        string nama_buku;
        int id_buku;
        string genre_buku;
        string penulis;
        string review[5];
        string yang_review[5];
        int jum_review = 0;
    };

    Pelanggan akun[5];
    int jum_akun = 0;
	
    Buku buku[65];
    Buku sementara;
    int jum_buku = 60;

    int index_akun = -1;

//-------------------- ISI DATA --------------------

   void isi_data_buku() {
    buku[0].nama_buku = "Laskar Pelangi";
    buku[0].id_buku = 1001;
    buku[0].genre_buku = "Drama";
    buku[0].penulis = "Andrea Hirata";

    buku[1].nama_buku = "Bumi";
    buku[1].id_buku = 1002;
    buku[1].genre_buku = "Fantasi";
    buku[1].penulis = "Tere Liye";

    buku[2].nama_buku = "Negeri 5 Menara";
    buku[2].id_buku = 1003;
    buku[2].genre_buku = "Inspirasi";
    buku[2].penulis = "Ahmad Fuadi";

    buku[3].nama_buku = "Dilan 1990";
    buku[3].id_buku = 1004;
    buku[3].genre_buku = "Romance";
    buku[3].penulis = "Pidi Baiq";

    buku[4].nama_buku = "Perahu Kertas";
    buku[4].id_buku = 1005;
    buku[4].genre_buku = "Romance";
    buku[4].penulis = "Dee Lestari";

    buku[5].nama_buku = "Filosofi Teras";
    buku[5].id_buku = 1006;
    buku[5].genre_buku = "Filsafat";
    buku[5].penulis = "Henry Manampiring";

    buku[6].nama_buku = "Ayat-Ayat Cinta";
    buku[6].id_buku = 1007;
    buku[6].genre_buku = "Romantis";
    buku[6].penulis = "Habiburrahman El Shirazy";

    buku[7].nama_buku = "Selamat Tinggal";
    buku[7].id_buku = 1008;
    buku[7].genre_buku = "Relasi";
    buku[7].penulis = "Tere Liye";

    buku[8].nama_buku = "Critical Eleven";
    buku[8].id_buku = 1009;
    buku[8].genre_buku = "Drama";
    buku[8].penulis = "Ika Natassa";

    buku[9].nama_buku = "Dear Nathan";
    buku[9].id_buku = 1010;
    buku[9].genre_buku = "Remaja";
    buku[9].penulis = "Erisca Febriani";
    
    buku[10].nama_buku = "Mariposa";
    buku[10].id_buku = 1011;
    buku[10].genre_buku = "Romantis";
    buku[10].penulis = "Luluk HF";

    buku[11].nama_buku = "Imperfect";
    buku[11].id_buku = 1012;
    buku[11].genre_buku = "Komedi";
    buku[11].penulis = "Meira Anastasia";

    buku[12].nama_buku = "Galaksi";
    buku[12].id_buku = 1013;
    buku[12].genre_buku = "Remaja";
    buku[12].penulis = "Poppi Pertiwi";

    buku[13].nama_buku = "Pintu Harmonika";
    buku[13].id_buku = 1014;
    buku[13].genre_buku = "Keluarga";
    buku[13].penulis = "Clara Ng";

    buku[14].nama_buku = "Koala Kumal";
    buku[14].id_buku = 1015;
    buku[14].genre_buku = "Komedi";
    buku[14].penulis = "Raditya Dika";

    buku[15].nama_buku = "Sang Pemimpi";
    buku[15].id_buku = 1016;
    buku[15].genre_buku = "Pendidikan";
    buku[15].penulis = "Andrea Hirata";

    buku[16].nama_buku = "Hujan";
    buku[16].id_buku = 1017;
    buku[16].genre_buku = "Fiksi Ilmiah";
    buku[16].penulis = "Tere Liye";

    buku[17].nama_buku = "Rectoverso";
    buku[17].id_buku = 1018;
    buku[17].genre_buku = "Cinta";
    buku[17].penulis = "Dee Lestari";

    buku[18].nama_buku = "Tentang Kamu";
    buku[18].id_buku = 1019;
    buku[18].genre_buku = "Misteri";
    buku[18].penulis = "Tere Liye";

    buku[19].nama_buku = "Sabtu Bersama Bapak";
    buku[19].id_buku = 1020;
    buku[19].genre_buku = "Keluarga";
    buku[19].penulis = "Adhitya Mulya";
    
    buku[20].nama_buku = "Cinta Brontosaurus";
    buku[20].id_buku = 1021;
    buku[20].genre_buku = "Komedi";
    buku[20].penulis = "Raditya Dika";

    buku[21].nama_buku = "The Little Prince";
    buku[21].id_buku = 1022;
    buku[21].genre_buku = "Anak-anak";
    buku[21].penulis = "Antoine de Saint-Exup√©ry";

    buku[22].nama_buku = "The Alchemist";
    buku[22].id_buku = 1023;
    buku[22].genre_buku = "Filsafat";
    buku[22].penulis = "Paulo Coelho";

    buku[23].nama_buku = "1984";
    buku[23].id_buku = 1024;
    buku[23].genre_buku = "Dystopia";
    buku[23].penulis = "George Orwell";

    buku[24].nama_buku = "Animal Farm";
    buku[24].id_buku = 1025;
    buku[24].genre_buku = "Politik";
    buku[24].penulis = "George Orwell";

    buku[25].nama_buku = "To Kill a Mockingbird";
    buku[25].id_buku = 1026;
    buku[25].genre_buku = "Sosial";
    buku[25].penulis = "Harper Lee";

    buku[26].nama_buku = "Pride and Prejudice";
    buku[26].id_buku = 1027;
    buku[26].genre_buku = "Romantis";
    buku[26].penulis = "Jane Austen";

    buku[27].nama_buku = "Looking for Alaska";
    buku[27].id_buku = 1028;
    buku[27].genre_buku = "Remaja";
    buku[27].penulis = "John Green";

    buku[28].nama_buku = "Paper Towns";
    buku[28].id_buku = 1029;
    buku[28].genre_buku = "Remaja";
    buku[28].penulis = "John Green";

    buku[29].nama_buku = "Daun yang Jatuh Tak Pernah Membenci Angin";
    buku[29].id_buku = 1030;
    buku[29].genre_buku = "Drama";
    buku[29].penulis = "Tere Liye";

    buku[30].nama_buku = "Negeri Para Bedebah";
    buku[30].id_buku = 1031;
    buku[30].genre_buku = "Politik";
    buku[30].penulis = "Tere Liye";

    buku[31].nama_buku = "Negeri di Ujung Tanduk";
    buku[31].id_buku = 1032;
    buku[31].genre_buku = "Politik";
    buku[31].penulis = "Tere Liye";

    buku[32].nama_buku = "Berjuta Rasanya";
    buku[32].id_buku = 1033;
    buku[32].genre_buku = "Cinta";
    buku[32].penulis = "Tere Liye";

    buku[33].nama_buku = "Filosofi Kopi";
    buku[33].id_buku = 1034;
    buku[33].genre_buku = "Drama";
    buku[33].penulis = "Dee Lestari";

    buku[34].nama_buku = "Balada Si Roy";
    buku[34].id_buku = 1035;
    buku[34].genre_buku = "Remaja";
    buku[34].penulis = "Gol A Gong";

    buku[35].nama_buku = "Ronggeng Dukuh Paruk";
    buku[35].id_buku = 1036;
    buku[35].genre_buku = "Sosial";
    buku[35].penulis = "Ahmad Tohari";

    buku[36].nama_buku = "Cantik Itu Luka";
    buku[36].id_buku = 1037;
    buku[36].genre_buku = "Sejarah";
    buku[36].penulis = "Eka Kurniawan";

    buku[37].nama_buku = "Lelaki Harimau";
    buku[37].id_buku = 1038;
    buku[37].genre_buku = "Mitologi";
    buku[37].penulis = "Eka Kurniawan";

    buku[38].nama_buku = "Laut dan Langit";
    buku[38].id_buku = 1039;
    buku[38].genre_buku = "Romantis";
    buku[38].penulis = "Dwitasari";

    buku[39].nama_buku = "Komet";
    buku[39].id_buku = 1040;
    buku[39].genre_buku = "Fantasi";
    buku[39].penulis = "Tere Liye";
    buku[40].nama_buku = "Komet Minor";
    buku[40].id_buku = 1041;
    buku[40].genre_buku = "Fantasi";
    buku[40].penulis = "Tere Liye";

    buku[41].nama_buku = "Selena";
    buku[41].id_buku = 1042;
    buku[41].genre_buku = "Fantasi";
    buku[41].penulis = "Tere Liye";

    buku[42].nama_buku = "Nebula";
    buku[42].id_buku = 1043;
    buku[42].genre_buku = "Fantasi";
    buku[42].penulis = "Tere Liye";

    buku[43].nama_buku = "Tikungan Tajam";
    buku[43].id_buku = 1044;
    buku[43].genre_buku = "Drama";
    buku[43].penulis = "Okky Madasari";

    buku[44].nama_buku = "Ayah";
    buku[44].id_buku = 1045;
    buku[44].genre_buku = "Keluarga";
    buku[44].penulis = "Andrea Hirata";

    buku[45].nama_buku = "Hati Suhita";
    buku[45].id_buku = 1046;
    buku[45].genre_buku = "Religi";
    buku[45].penulis = "Khila Rindani";

    buku[46].nama_buku = "Cinta dalam Gelas";
    buku[46].id_buku = 1047;
    buku[46].genre_buku = "Inspiratif";
    buku[46].penulis = "Andrea Hirata";

    buku[47].nama_buku = "Surat Kecil untuk Tuhan";
    buku[47].id_buku = 1048;
    buku[47].genre_buku = "Keluarga";
    buku[47].penulis = "Agnes Davonar";

    buku[48].nama_buku = "Catatan Najwa";
    buku[48].id_buku = 1049;
    buku[48].genre_buku = "Sosial Politik";
    buku[48].penulis = "Najwa Shihab";

    buku[49].nama_buku = "Orang-Orang Biasa";
    buku[49].id_buku = 1050;
    buku[49].genre_buku = "Sosial";
    buku[49].penulis = "Andrea Hirata";

    buku[50].nama_buku = "Bumi Manusia";
    buku[50].id_buku = 1051;
    buku[50].genre_buku = "Sejarah";
    buku[50].penulis = "Pramoedya Ananta Toer";

    buku[51].nama_buku = "Anak Semua Bangsa";
    buku[51].id_buku = 1052;
    buku[51].genre_buku = "Sejarah";
    buku[51].penulis = "Pramoedya Ananta Toer";

    buku[52].nama_buku = "Jejak Langkah";
    buku[52].id_buku = 1053;
    buku[52].genre_buku = "Sejarah";
    buku[52].penulis = "Pramoedya Ananta Toer";

    buku[53].nama_buku = "Rumah Kaca";
    buku[53].id_buku = 1054;
    buku[53].genre_buku = "Sejarah";
    buku[53].penulis = "Pramoedya Ananta Toer";

    buku[54].nama_buku = "This Earth of Mankind";
    buku[54].id_buku = 1055;
    buku[54].genre_buku = "Sejarah";
    buku[54].penulis = "Pramoedya Ananta Toer";

    buku[55].nama_buku = "Sang Penari";
    buku[55].id_buku = 1056;
    buku[55].genre_buku = "Budaya";
    buku[55].penulis = "Ahmad Tohari";

    buku[56].nama_buku = "Manusia Setengah Salmon";
    buku[56].id_buku = 1057;
    buku[56].genre_buku = "Komedi";
    buku[56].penulis = "Raditya Dika";

    buku[57].nama_buku = "Jalan Pulang";
    buku[57].id_buku = 1058;
    buku[57].genre_buku = "Fiksi";
    buku[57].penulis = "Tere Liye";

    buku[58].nama_buku = "Cinta dalam Diam";
    buku[58].id_buku = 1059;
    buku[58].genre_buku = "Religi";
    buku[58].penulis = "Felix Siauw";

    buku[59].nama_buku = "Bidadari Bermata Bening";
    buku[59].id_buku = 1060;
    buku[59].genre_buku = "Religi";
    buku[59].penulis = "Habiburrahman El Shirazy";
    
    buku[60].nama_buku = "Atomic Habits";
    buku[60].id_buku = 1061;
    buku[60].genre_buku = "Self-Help";
    buku[60].penulis = "James Clear";
    
    buku[61].nama_buku = "La Tahzan";
    buku[61].id_buku = 1062;
    buku[61].genre_buku = "Religi";
    buku[61].penulis = "'Aidh Al-Qarni";
    
    buku[62].nama_buku = "Struktur Data dan Algoritma";
    buku[62].id_buku = 1063;
    buku[62].genre_buku = "Pendidikan";
    buku[62].penulis = "Abdul Kadir";
    
    buku[63].nama_buku = "Kisah 25 Nabi dan Rasul";
    buku[63].id_buku = 1064;
    buku[63].genre_buku = "Religi, Pendidikan";
    buku[63].penulis = "Tim Edukatif";
    
    buku[64].nama_buku = "Sherlock Holmes";
    buku[64].id_buku = 1065;
    buku[64].genre_buku = "Detektif";
    buku[64].penulis = "Sir Arthur Conan Doyle";
}

    void muat_data_akun() {
	    ifstream fin("data_akun.txt");
	    if (!fin.is_open()) return;
	
	    fin >> jum_akun;
	    fin.ignore();
	
	    for (int i = 0; i < jum_akun; i++) {
	        getline(fin, akun[i].username);
	        getline(fin, akun[i].nama);
	        fin >> akun[i].umur;
	        fin.ignore();
	        getline(fin, akun[i].sandi);
	        fin >> akun[i].jum_sewa;
	        fin.ignore();
	
	        for (int j = 0; j < akun[i].jum_sewa; j++) {
	            getline(fin, akun[i].buku_sewa[j]);
	            fin >> akun[i].hari_sewa[j];
	            fin >> akun[i].harga_sewa[j];
	            fin.ignore();
	        }
	
	        fin >> akun[i].jum_review;
	        fin.ignore();
	        for (int j = 0; j < akun[i].jum_review; j++) {
	            getline(fin, akun[i].review_buku[j]);
	        }
	    }
		fin.close();
	}
	
	void muat_data_buku() {
		ifstream fin("data_buku.txt");
		if (!fin.is_open()) return;
		
	    fin >> jum_buku;
	    fin.ignore();
	
	    for (int i = 0; i < jum_buku; i++) {
	        getline(fin, buku[i].nama_buku);
	        fin >> buku[i].id_buku;
	        fin.ignore();
	        getline(fin, buku[i].genre_buku);
	        getline(fin, buku[i].penulis);
	        fin >> buku[i].jum_review;
	        fin.ignore();
	
	        for (int j = 0; j < buku[i].jum_review; j++) {
	            getline(fin, buku[i].review[j]);
	            getline(fin, buku[i].yang_review[j]);
	        }
	    }
	
	    fin.close();
	}

public:
	
//-------------------- FITUR MEMUAT DATA --------------------

    Perpus() {
        isi_data_buku();
        muat_data_akun(); 
		muat_data_buku(); 
    }
    
//-------------------- FITUR MENYIMPAN DATA --------------------
    
    void simpan_data_akun() {
	    ofstream fout("data_akun.txt");
	
	    // Simpan jumlah akun
	    fout << jum_akun << endl;
	    for (int i = 0; i < jum_akun; i++) {
	        fout << akun[i].username << endl;
	        fout << akun[i].nama << endl;
	        fout << akun[i].umur << endl;
	        fout << akun[i].sandi << endl;
	        fout << akun[i].jum_sewa << endl;
	        for (int j = 0; j < akun[i].jum_sewa; j++) {
	            fout << akun[i].buku_sewa[j] << endl;
	            fout << akun[i].hari_sewa[j] << endl;
	            fout << akun[i].harga_sewa[j] << endl;
	        }
	        fout << akun[i].jum_review << endl;
	        for (int j = 0; j < akun[i].jum_review; j++) {
	            fout << akun[i].review_buku[j] << endl;
	        }
	    }
	
	    fout.close();
	}
	
	void simpan_data_buku() {
		ofstream fout("data_buku.txt");
		
		// Simpan jumlah buku
	    fout << jum_buku << endl;
	    for (int i = 0; i < jum_buku; i++) {
	        fout << buku[i].nama_buku << endl;
	        fout << buku[i].id_buku << endl;
	        fout << buku[i].genre_buku << endl;
	        fout << buku[i].penulis << endl;
	        fout << buku[i].jum_review << endl;
	        for (int j = 0; j < buku[i].jum_review; j++) {
	            fout << buku[i].review[j] << endl;
	            fout << buku[i].yang_review[j] << endl;
	        }
	    }
	
	    fout.close();
	}
	
//-------------------- FITUR UMUM --------------------

    void tampil_buku() {
    	cout << "\n+=============================================+" << endl;
    	cout << "|                DAFTAR BUKU                  |" << endl;
    	cout << "+=============================================+" << endl;

    	if (jum_buku == 0) {
        cout << "|         Tidak ada data buku tersedia        |" << endl;
    	}

    	for (int i = 0; i < jum_buku; i++) {
        cout << "| " << i + 1 << ". Judul   : " << buku[i].nama_buku << endl;
        cout << "|    ID      : " << buku[i].id_buku << endl;
        cout << "|    Genre   : " << buku[i].genre_buku << endl;
        cout << "|    Penulis : " << buku[i].penulis << endl;
        cout << "+---------------------------------------------+" << endl;
    	}
	}

    void cari_buku() {
        string cari;
        bool ditemukan = false;
        
        cin.ignore();
        cout << "\n+=======================================+" << endl;
		cout << "|              CARI BUKU                |" << endl;
		cout << "+=======================================+" << endl;
		cout << "| Masukkan nama buku: ";
		getline(cin, cari);
		cout << "+---------------------------------------+" << endl;

        for (int i = 0; i < jum_buku; i++) {
            if (buku[i].nama_buku == cari) {
                tampilkan_buku(buku[i]);
                ditemukan = true;

                if (buku[i].jum_review > 0) {
            		cout << "\n+=============== REVIEW ===============+" << endl;
            		for (int j = 0; j < buku[i].jum_review; j++) {
                		cout << "| - " << buku[i].review[j]
                     		 << " [Oleh " << buku[i].yang_review[j] << "]" << endl;
            	}
            		cout << "+========================================+" << endl;
        		} else {
            		cout << "| Belum ada review untuk buku ini.       |" << endl;
            		cout << "+----------------------------------------+" << endl;
        		}
            }
        }

        if (!ditemukan) {
            cout << "\n+----------------------------------+" << endl;
    		cout << "|      Buku tidak ditemukan.       |" << endl;
    		cout << "+----------------------------------+" << endl;
        }
    }
    
    void cari_buku_id() {
	    int cari;
	    bool ditemukan = false;
	
	    cin.ignore();
	    cout << "\n+=======================================+" << endl;
	    cout << "|           CARI BUKU DARI ID           |" << endl;
	    cout << "+=======================================+" << endl;
	    cout << "| Masukkan ID buku: ";
	    cin >> cari;
	    cout << "+---------------------------------------+" << endl;
	
	    // Binary search
	    int kiri = 0, kanan = jum_buku - 1;
	    while (kiri <= kanan) {
	        int tengah = (kiri + kanan) / 2;
	        if (buku[tengah].id_buku == cari) {
	            tampilkan_buku(buku[tengah]);
	            ditemukan = true;
	
	            if (buku[tengah].jum_review > 0) {
	                cout << "\n+=============== REVIEW ===============+" << endl;
	                for (int j = 0; j < buku[tengah].jum_review; j++) {
	                    cout << "| - " << buku[tengah].review[j]
	                         << " [Oleh " << buku[tengah].yang_review[j] << "]" << endl;
	                }
	                cout << "+========================================+" << endl;
	            } else {
	                cout << "| Belum ada review untuk buku ini.       |" << endl;
	                cout << "+----------------------------------------+" << endl;
	            }
	
	            break;
	        } else if (buku[tengah].id_buku < cari) {
	            kiri = tengah + 1;
	        } else {
	            kanan = tengah - 1;
	        }
	    }
	
	    if (!ditemukan) {
	        cout << "\n+--------------------------------+" << endl;
	        cout << "|       Buku tidak ditemukan.     |" << endl;
	        cout << "+--------------------------------+" << endl;
	    }
	}

    void tampilkan_buku(Buku b) {
        cout << "\n+========================================+" << endl;
    	cout << "|               INFO BUKU                |" << endl;
    	cout << "+========================================+" << endl;
    	cout << "| Judul   : " << b.nama_buku << endl;
    	cout << "| ID      : " << b.id_buku << endl;
    	cout << "| Genre   : " << b.genre_buku << endl;
    	cout << "| Penulis : " << b.penulis << endl;
    	cout << "+========================================+" << endl;
    }

//-------------------- FITUR PELANGGAN --------------------

    void daftar_akun() {
    	string username;
    	bool username_valid = true;
    	
        if (jum_akun >= 5) {
            cout << "Kuota akun sudah maksimal" << endl;
            return;
        }

        cout << endl;
		cout << "+==========================================+" << endl;
		cout << "|           DAFTAR AKUN BARU	           |" << endl;
		cout << "+==========================================+" << endl;
		cout << "| Masukkan nama anda : ";
		cin.ignore();
		getline(cin, akun[jum_akun].nama);
		
		cout << "| Masukkan umur anda : ";
        cin >> akun[jum_akun].umur;
		
		do {
        username_valid = true;
        cout << "| Masukkan username untuk akun Anda : ";
        cin >> username;

	        for (int i = 0; i < jum_akun; i++) {
	            if (username == akun[i].username) {
	                cout << "| Username sudah digunakan.                |" << endl;
            		cout << "| Silakan pilih yang lain.                 |" << endl;
            		cout << "+------------------------------------------+" << endl << endl;
	                username_valid = false;
	                break;
            	}
        	}
    	} while (!username_valid);

    	akun[jum_akun].username = username;
		
        cout << "| Masukkan sandi baru untuk akun Anda : ";
		cin >> akun[jum_akun].sandi;

		cout << "+-------------------------------------------+" << endl;
		cout << "| Akun \"" << akun[jum_akun].username << "\" berhasil dibuat!              |" << endl;
		cout << "+===========================================+" << endl;

		jum_akun++;
    }
    
    void ganti_sandi() {
    	string lama, baru;
    	
    	cout << endl;
		cout << "+=====================================+" << endl;
		cout << "|             GANTI SANDI             |" << endl;
		cout << "+=====================================+" << endl;
    	
    	cout << "| Masukkan sandi lama: ";
    	cin >> lama;

    	if (lama != akun[index_akun].sandi) {
        	cout << "Sandi lama salah" << endl;
        	ganti_sandi();
    	}

    	cout << "| Masukkan sandi baru: ";
    	cin >> baru;
    	
    	if (baru == akun[index_akun].sandi) {
    		cout << "| Sandi tidak boleh sama seperti sandi lama" << endl;
    		ganti_sandi();
		} else {
    		akun[index_akun].sandi = baru;
    		cout << "Sandi berhasil diganti!" << endl;
		}

	}

    void login_akun() {
        string user, pass;
        
        cout << endl;
		cout << "+=====================================+" << endl;
		cout << "|             LOGIN AKUN              |" << endl;
		cout << "+=====================================+" << endl;
		cout << "| Masukkan username : ";
		cin >> user;
		cout << "| Masukkan sandi    : ";
		cin >> pass;

        bool login_berhasil = false;

        for (int i = 0; i < jum_akun; i++) {
            if (akun[i].username == user && akun[i].sandi == pass) {
                index_akun = i;
                login_berhasil = true;
                
                cout << "\nLogin berhasil. Selamat datang, " << akun[i].nama << "!" << endl;
                system("pause");
                system("cls");
                m_pelanggan_2();
                break;
            }
        }

        if (!login_berhasil) {
    	cout << "+-------------------------------------+" << endl;
    	cout << "|     Username atau sandi salah.      |" << endl;
    	cout << "+=====================================+" << endl;
		}
    }
    
    void penyewaan(int sewa) {
        int hari;
        int i;

        if (akun[index_akun].jum_sewa >= 5) {
            cout << "Anda sudah menyewa 5 buku, tidak bisa menyewa lagi" << endl;
            return;
        }

        cout << endl;
		cout << "+=============================================+" << endl;
		cout << "|                  SEWA BUKU                  |" << endl;
		cout << "+=============================================+" << endl;
		cout << "| Nama buku yang akan disewa:                 |" << endl;
		cout << "+---------------------------------------------+" << endl;

        cin.ignore();
        bool ditemukan = false;
        string cari;
        cout << "| Masukkan nama buku: ";
        getline(cin, cari);
        cout << "+---------------------------------------------+" << endl;

        for (i = 0; i < jum_buku; i++) {
            if (buku[i].nama_buku == cari) {
                tampilkan_buku(buku[i]);
                ditemukan = true;

                if (ditemukan) {
                    do {
                        cout << "| Sewa untuk berapa hari: ";
                        cin >> hari;

                        if (hari == 0) {
                            cout << "+---------------------------------------------+" << endl;
                    		cout << "| Tidak bisa menyewa selama 0 hari            |" << endl;
                        }

                    } while (hari == 0);

                    akun[index_akun].hari_sewa[akun[index_akun].jum_sewa] = hari;
                    akun[index_akun].harga_sewa[akun[index_akun].jum_sewa] = hari * 3000;
                    akun[index_akun].buku_sewa[akun[index_akun].jum_sewa] = buku[i].nama_buku;
                    akun[index_akun].jum_sewa++;
                    
                    cout << "+---------------------------------------------+" << endl;
            		cout << "| Buku berhasil disewa.                       |" << endl;
            		cout << "+=============================================+" << endl;
                }
            }
        }

        if (!ditemukan) {
    	cout << "+-------------------------------------------------+" << endl;
    	cout << "|               Buku tidak ditemukan              |" << endl;
    	cout << "+=================================================+" << endl;
		}
    }

    void review_buku() {
        string cari;
        int i;
        string review;

        cout << endl;
		cout << "+=============================================+" << endl;
		cout << "|                 REVIEW BUKU                 |" << endl;
		cout << "+=============================================+" << endl;
		cout << "| Nama buku yang akan direview:               |" << endl;
		cout << "+---------------------------------------------+" << endl;

		cout << "| Masukkan nama buku: ";
		cin >> ws;
		getline(cin, cari);
		cout << "+---------------------------------------------+" << endl;

        bool ditemukan = false;

        for (i = 0; i < jum_buku; i++) {
            if (buku[i].nama_buku == cari) {
                tampilkan_buku(buku[i]);
                ditemukan = true;

                if (buku[i].jum_review >= 5) {
                    cout << "| Buku ini sudah mencapai batas review max.  |" << endl;
            		cout << "+=============================================+" << endl;
                } else {
                    cout << "| Berikan review untuk buku: " << buku[i].nama_buku << endl;
            		cout << "+---------------------------------------------+" << endl;
                    getline(cin, akun[index_akun].review_buku[akun[index_akun].jum_review]);

                    buku[i].review[buku[i].jum_review] = akun[index_akun].review_buku[akun[index_akun].jum_review];
                    buku[i].yang_review[buku[i].jum_review] = akun[index_akun].nama;

                    buku[i].jum_review++;
                    akun[index_akun].jum_review++;
                }
            }
        }

        if (!ditemukan) {
    	cout << "+---------------------------------------------+" << endl;
    	cout << "|              Buku tidak ditemukan.          |" << endl;
    	cout << "+=============================================+" << endl;
		}
    }

//-------------------- FITUR KARYAWAN --------------------

   	void login_karyawan() {
    	string user;
    	string pass;
    	
    	cout << endl;
		cout << "+===========================================+" << endl;
		cout << "|         LOGIN SEBAGAI KARYAWAN            |" << endl;
		cout << "+===========================================+" << endl;

		cout << "| Masukkan username : ";
		cin >> user;
		cout << "| Masukkan sandi    : ";
		cin >> pass;
		cout << "+-------------------------------------------+" << endl;

		bool login_berhasil = false;

		if (user == "karyawan" && pass == "neuf9") {
    	login_berhasil = true;

    	cout << "|         Anda berhasil login!              |" << endl;
    	cout << "+===========================================+" << endl;
    	system("pause");
    	system("cls");

    	m_karyawan();
		}

		if (!login_berhasil) {
    	cout << "|     Username atau sandi salah!            |" << endl;
    	cout << "+===========================================+" << endl;
    	system("pause");
    	system("cls");
		}
	}
	
	void input_data_buku() {
	    if (jum_buku >= 65) {
	        cout << "\nJumlah maksimal buku telah tercapai.\n";
	        return;
	    }
	
	    cout << "\n+===========================================+" << endl;
		cout << "|           INPUT DATA BUKU BARU            |" << endl;
		cout << "+===========================================+" << endl;

		cin.clear();
		cin.ignore(numeric_limits<streamsize>::max(), '\n');

		cout << "| Masukkan nama buku  : ";
		getline(cin, buku[jum_buku].nama_buku);

		if (jum_buku > 0)
    	buku[jum_buku].id_buku = buku[jum_buku - 1].id_buku + 1;

		cout << "| Masukkan genre buku : ";
		getline(cin, buku[jum_buku].genre_buku);

		cout << "| Masukkan penulis    : ";
		getline(cin, buku[jum_buku].penulis);

		cout << "+-------------------------------------------+" << endl;
		cout << "|       Buku berhasil ditambahkan!          |" << endl;
		cout << "+===========================================+" << endl;

		jum_buku++;
	}

    void tampil_data_anggota() {
		cout << "\n+===========================================+" << endl;
    	cout << "|         DAFTAR AKUN PELANGGAN             |" << endl;
    	cout << "+===========================================+" << endl;

    for (int i = 0; i < jum_akun; i++) {
        cout << "| " << i + 1 << ". Nama     : " << akun[i].nama << endl;
        cout << "|    Umur     : " << akun[i].umur << endl;
        cout << "|    Username : " << akun[i].username << endl;
        cout << "+-------------------------------------------+" << endl;
    }

    if (jum_akun == 0) {
        cout << "|       Belum ada akun yang terdaftar       |" << endl;
        cout << "+===========================================+" << endl;
    }
	}
    
    void lihat_review() {
    	cout << endl;
		cout << "+==========================================+" << endl;
		cout << "|         LIHAT SELURUH REVIEW             |" << endl;
		cout << "+==========================================+" << endl;

		bool ada_review = false;

		for (int i = 0; i <= jum_buku; i++) {
    		if (buku[i].jum_review > 0) {
        		ada_review = true;
		
        cout << "| Buku: " << buku[i].nama_buku << endl;
        cout << "+------------------------------------------+" << endl;

        for (int j = 0; j < buku[i].jum_review; j++) {
        cout << "| " << j + 1 << ". " << buku[i].review[j] 
             << " [Oleh: " << buku[i].yang_review[j] << "]" << endl;
        }
        cout << "+------------------------------------------+" << endl;
    	}
	}

	if (!ada_review) {
    	cout << "| Belum ada review yang terdaftar          |" << endl;
    	cout << "+==========================================+" << endl;
	}
	}
	
	void urut_abjad() {
	    for (int i = 0; i < jum_buku - 1; i++) {
	        for (int j = i + 1; j < jum_buku; j++) {
	            if (buku[i].nama_buku > buku[j].nama_buku) {
	                sementara = buku[i];
	                buku[i] = buku[j];
	                buku[j] = sementara;
	            }
	        }
	    }
	    cout << "\nData buku berhasil diurutkan berdasarkan abjad A-Z\n";
	}
	
	void urut_id() {	
	    for (int i = 0; i < jum_buku - 1; i++) {
	        for (int j = i + 1; j < jum_buku; j++) {
	            if (buku[i].id_buku > buku[j].id_buku) {
	                sementara = buku[i];
	                buku[i] = buku[j];
	                buku[j] = sementara;
	            }
	        }
	    }
	    cout << "\nData buku berhasil diurutkan berdasarkan ID\n";
	}
	
	void lihat_sewa() {
		bool ada;
		
		cout << "\n+==========================================+" << endl;
		cout << "|         DAFTAR PENYEWA BUKU              |" << endl;
		cout << "+==========================================+" << endl;
		
		for (int i = 0; i < jum_akun; i++) {
	        if (akun[i].jum_sewa > 0) {
	            ada = true;
	            
	            cout << "| Nama : " << akun[i].username << " (" << akun[i].nama << ")" << endl;
        		cout << "| Buku yang disewa:" << endl;

        		for (int j = 0; j < akun[i].jum_sewa; j++) {
            	cout << "|   " << j+1 << ". " << akun[i].buku_sewa[j]
                 	 << " (" << akun[i].hari_sewa[j]
                     << " Hari | Rp. " << akun[i].harga_sewa[j] << ")" << endl;
        		}

        		cout << "+------------------------------------------+" << endl;
    		}
		}

	    if (!ada) {
    	cout << "| Tidak ada buku yang sedang disewa        |" << endl;
    	cout << "+==========================================+" << endl;
		}
	}

//-------------------- MENU PELANGGAN --------------------

    void m_pelanggan() {
        int pilih;
        
        do {
            cout << "+==============================+" << endl;
			cout << "|       MENU PELANGGAN         |" << endl;
			cout << "+==============================+" << endl;
			cout << "| (1) Daftar Akun Baru         |" << endl;
			cout << "| (2) Login Akun               |" << endl;
			cout << "| (3) Lihat Semua Buku         |" << endl;
			cout << "| (4) Cari Buku melalui Nama   |" << endl;
			cout << "| (5) Cari Buku melalui ID     |" << endl;
			cout << "| (6) Kembali ke Menu Utama    |" << endl;
			cout << "+==============================+" << endl;
			cout << "Masukkan pilihan anda: ";
            cin >> pilih;

            switch (pilih) {
                case 1:
                    daftar_akun();
                    system("pause");
                    system("cls");
                    break;
                case 2:
                    login_akun();
                    system("pause");
                    system("cls");
                    break;
                case 3:
                    tampil_buku();
                    system("pause");
                    system("cls");
                    break;
                case 4:
                    cari_buku();
                    system("pause");
                    system("cls");
                    break;
                case 5:
                	cari_buku_id();
                    system("pause");
                    system("cls");
                    break;
                case 6:
                    system("pause");
                    system("cls");
                    break;
                default:
                    cout << "\nPilihan tidak tersedia!" << endl;
                    system("pause");
                    system("cls");
                    break;
            }
        } while (pilih != 6);
    }
    
    void m_pelanggan_2() {
        int pilih;
        long int harga_total=0;
        
        do {
            cout << "+==============================+" << endl;
			cout << "|       MENU PELANGGAN 2       |" << endl;
			cout << "+==============================+" << endl;
			cout << "| (1) Sewa Buku                |" << endl;
			cout << "| (2) Lihat Semua Buku         |" << endl;
			cout << "| (3) Cari Buku                |" << endl;
			cout << "| (4) Review Buku              |" << endl;
			cout << "| (5) Ganti Sandi Akun         |" << endl;
			cout << "| (6) Lihat Buku yang Anda Sewa|" << endl;
			cout << "| (7) Kembali ke Menu Utama    |" << endl;
			cout << "+==============================+" << endl;
			cout << "Masukkan pilihan anda: ";
            cin >> pilih;

            switch (pilih) {
                case 1:
                    penyewaan(akun[index_akun].jum_sewa);
                    system("pause");
                    system("cls");
                    break;
                case 2:
                    tampil_buku();
                    system("pause");
                    system("cls");
                    break;
                case 3:
                    cari_buku();
                    system("pause");
                    system("cls");
                    break;
                case 4:
                    review_buku();
                    system("pause");
                    system("cls");
                    break;
                case 5:
                	ganti_sandi();
                	system("pause");
                    system("cls");
                case 6:
                    if (akun[index_akun].jum_sewa > 0) {
                     
                    cout << "\n+=============================================+" << endl;
    				cout << "|             BUKU YANG ANDA SEWA             |" << endl;
    				cout << "+=============================================+" << endl;
                    
                    for (int i = 0; i < akun[index_akun].jum_sewa; i++) {
                            cout << "| (" << i + 1 << ") " << akun[index_akun].buku_sewa[i] << " ( "<< akun[index_akun].hari_sewa[i] << " Hari )" << endl;
                        }	
			            cout << "+=============================================+" << endl;
                    } else if (akun[index_akun].jum_sewa == 0) {
                        cout << "\n+=============================================+" << endl;
    					cout << "|           ANDA BELUM MENYEWA BUKU           |" << endl;
    					cout << "+=============================================+" << endl;
                    }
                    system("pause");					                    	
                    system("cls");
                    break;
                case 7:
                    if (akun[index_akun].jum_sewa > 0) {
    					cout << "\n+=============================================+" << endl;
    					cout << "|           STRUK PEMINJAMAN BUKU             |" << endl;
    					cout << "+=============================================+" << endl;
    					cout << "| Nama           : " << akun[index_akun].nama << endl;
    					cout << "|---------------------------------------------|" << endl;
    					cout << "| Judul Buku:                                 |" << endl;
    					for (int i = 0; i < akun[index_akun].jum_sewa; i++) {
        				cout << "|   " << i + 1 << ". " << akun[index_akun].buku_sewa[i] << endl;
    					}
    					cout << "|---------------------------------------------|" << endl;
    					cout << "| Lama Sewa & Biaya:                          |" << endl;
    					for (int i = 0; i < akun[index_akun].jum_sewa; i++) {
        				cout << "|   " << i + 1 << ". " << akun[index_akun].hari_sewa[i]
             				 << " Hari = Rp. " << akun[index_akun].harga_sewa[i] << endl;
        				harga_total += akun[index_akun].harga_sewa[i];
    					}
    					cout << "|---------------------------------------------|" << endl;
    					cout << "| Harga Total    : Rp. " << harga_total << endl;
    					cout << "| Tanggal Pinjam : " << __DATE__ << " (simulasi)" << endl;
    					cout << "+=============================================+" << endl;
						} else if (akun[index_akun].jum_sewa == 0) {
    					return;
						}
                    break;
                default:
                    cout << endl << "Pilihan tidak tersedia!" << endl;
                    system("pause");
                    system("cls");
                    break;
            }
        } while (pilih != 7);
    }

//-------------------- MENU KARYAWAN --------------------
    
    void m_karyawan() {
        int pilih;
        int pilih_urut;
        
        do {
            cout << "\n+===========================================+" << endl;
			cout << "|              MENU KARYAWAN                |" << endl;
			cout << "+===========================================+" << endl;
			cout << "|  (1) Input Data Buku                      |" << endl;
			cout << "|  (2) Lihat Data Buku                      |" << endl;
			cout << "|  (3) Urutkan Data Buku                    |" << endl;
			cout << "|  (4) Lihat Seluruh Review Buku            |" << endl;
			cout << "|  (5) Lihat Daftar Penyewa                 |" << endl;
			cout << "|  (6) Lihat Data Pelanggan                 |" << endl;
			cout << "|  (7) Kembali ke Menu Utama                |" << endl;
			cout << "+===========================================+" << endl;
			cout << "Masukkan pilihan anda : ";
            cin >> pilih;

            switch (pilih) {
                case 1:
                    input_data_buku();
                    system("pause");
                    system("cls");
                    break;
                case 2:
                    tampil_buku();
                    system("pause");
                    system("cls");
                    break;
                case 3:
                	cout << endl << "(1) Abjad" << endl;
                	cout << "(2) ID" << endl;
                	cout << "Urutkan sesuai : " << endl;
                	cin >> pilih_urut;
                	
                	if(pilih_urut == 1) {
                		urut_abjad();
                		system("pause");
                    	system("cls");
					} else if (pilih_urut == 2) {
						urut_id();
						system("pause");
                    	system("cls");
					} else {
						cout << "Pilihan tidak tersedia" << endl;
				 		system("pause");
                    	system("cls");
					}
					break;
                case 4:
                    lihat_review();
                    system("pause");
                    system("cls");
                    break;
                case 5:
                	lihat_sewa();
                	system("pause");
                    system("cls");	
					break;
                case 6:
                    tampil_data_anggota();
                    system("pause");
                    system("cls");
                    break;
                case 7:
                    system("pause");
                    system("cls");
                    break;
                default:
                    cout << "Pilihan tidak tersedia!" << endl;
                    system("pause");
                    system("cls");
                    break;
            }
        } while (pilih != 7);
    }
    
};

//-------------------- MAIN --------------------

int main() {
    int pilih;
    Perpus neuf;

    do {
        cout << "\n+===============================================+" << endl;
    	cout << "|        SELAMAT DATANG DI PERPUSTAKAAN NEUF    |" << endl;
    	cout << "+===============================================+" << endl;
    	cout << "|  1. Login sebagai Pelanggan                   |" << endl;
    	cout << "|  2. Login sebagai Karyawan                    |" << endl;
    	cout << "|  3. Keluar                                    |" << endl;
    	cout << "+===============================================+" << endl;
    	cout << "Masukkan pilihan Anda: ";
        cin >> pilih;

        switch (pilih) {
            case 1:
                system("pause");
                system("cls");
                neuf.m_pelanggan();
                break;
            case 2:
                neuf.login_karyawan();
                break;
            case 3:
                cout << endl << "Terimakasih telah berkunjung di Perpustakaan Neuf!" << endl;
                break;
            default:
                cout << endl << "Pilihan tidak tersedia!" << endl << endl;
                system("pause");
                system("cls");
                break;
        }
    } while (pilih != 3);

	neuf.simpan_data_akun();
	neuf.simpan_data_buku();
	
    return 0;
}
